
class PDVerChecker : Thinker
{
	static bool isPD2()
	{
		string PD2PlayerClass = "Doomguybrush";
		class<Actor> cls = PD2PlayerClass;
		
		if(!cls)
			return false;
		else
			return true;
	}
}

class PDPuff : BulletPuff
{
	default
	{
	renderstyle "Translucent";
	alpha 0.7;
	scale 0.6;
	vspeed 0;
	decal "Bullet";
	+NOBLOCKMAP
	+NOGRAVITY
	+ALLOWPARTICLES
	+NOEXTREMEDEATH
	+NOINTERACTION
	}
	
	states
	{
	Spawn:
		TNT1 AA 0 A_SpawnItemEx("PDSparks",0,0,0,random(-5,5),random(-5,5),random(-5,5),random(1,360),0,0);
		HPUF A 2 BRIGHT A_JumpIf(pos.z <= floorz+4,"FloorHit");
		HPUF A 2 BRIGHT A_SpawnItem("PDPuff2");
		HPUF B 4 BRIGHT;
	Melee:
		HPUF C 4;
		stop;
	FloorHit:
		HGRN A 0;
		HGRN ABC 2 BRIGHT A_StartSound("puff/ric");
		HGRN DE 2 BRIGHT A_spawnitemex("PDSmoke1",0,0,0,0,0,1);
		Stop;
	}
}

class PDPuff2 : Actor
{
	Default
	{
	renderstyle "Translucent";
	alpha 0.7;
	PROJECTILE;
	Mass 1;
	+NOCLIP
	}
	
	States
	{
	Spawn:
		PUFF E 2;
		PUFF E 2 A_StartSound("puff/ric");
		PUFF FG 4 A_spawnitemex("PDSmoke1",0,0,0,0,0,1);
		Stop;
	}
}

class SwordPuff : Actor
{
	default
	{
	seesound "espada/hitflesh";
	+NOBLOCKMAP
	+NOGRAVITY
	-PUFFONACTORS
	-ALLOWPARTICLES
	+BLOODSPLATTER
	//decal nodecal
	}
	
	states
	{
	spawn:
		SWOR AAAAAAAA 0 A_SpawnItemEx("PDSparks",0,0,0,random(-5,5),random(-5,5),random(-5,5),random(1,360),0,SXF_NOCHECKPOSITION);
		stop;
	}
}

class SwordPuff2 : SwordPuff
{
	Default
	{
	+PUFFONACTORS
	attacksound "espada/hitwall";
	seesound "espada/hitflesh";
	}
	
	states
	{
	spawn:
		TNT1 A 0;
		stop;
	}
}

class PDVR_DUmmyPuff1 : Actor
{
	Default
	{
	Radius 1;
	Height 1;
	Speed 0;
	Damage 0;
	+NOINTERACTION;
	+NOGRAVITY;
	}
	
	States
	{
	Spawn:
		TNT1 A 0;
		TNT1 A 0 A_JumpIf(developer == 1, "showDot");
		TNT1 A 2;
		Stop;
	ShowDot:
		TNT1 A 2 A_SpawnParticle("FF 00 00", SPF_FULLBRIGHT, 1, 5);
		Stop;
	}
}

class PDSparks : Actor
{
	default
	{
	Projectile;
	Damage 0;
	Gravity .125;
	Speed 0;
	Radius 1;
	Height 1;
	Scale 0.6;
	+RIPPER
	+BLOODLESSIMPACT
	-NOGRAVITY
	//+DONTSPLASH
	}
	
	States
	{
	Spawn:
		WRBL ABAB 2 Bright;
		TNT1 A 0 A_Jump(128,1);
		Loop;
		WRBL CDCD 2 Bright;
		WRBL C 1 Bright A_FadeOut;
		Wait;
	Death:
		TNT1 A 1;
		Stop;
	}
}

class PDSparks2 : PDSparks
{
	default
	{
	GRAVITY .125;
	-SOLID
	+NOBLOCKMAP
	+THRUACTORS
	}
}